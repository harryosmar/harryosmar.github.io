3:I[6702,[],""]
5:I[8097,[],""]
6:I[4865,["513","static/chunks/513-54c786173a9c666c.js","122","static/chunks/122-1e2541ae7fd00b15.js","948","static/chunks/app/(content)/layout-98a57fd1c16e634e.js"],"NavTabs"]
7:I[4387,["185","static/chunks/app/layout-dc2409b386032b48.js"],"ThemeProvider"]
4:["slug","ai-ollama-structured-output","d"]
8:{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"}
9:{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"}
a:{"display":"inline-block"}
b:{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0}
0:["vVQ385s34AjXGKq4sfSim",[[["",{"children":["(content)",{"children":["articles",{"children":[["slug","ai-ollama-structured-output","d"],{"children":["__PAGE__?{\"slug\":\"ai-ollama-structured-output\"}",{}]}]}]}]},"$undefined","$undefined",true],["",{"children":["(content)",{"children":["articles",{"children":[["slug","ai-ollama-structured-output","d"],{"children":["__PAGE__",{},[["$L1","$L2",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/58640552b67a3ac6.css","precedence":"next","crossOrigin":"$undefined"}],["$","link","1",{"rel":"stylesheet","href":"/_next/static/css/6583aec57b22070b.css","precedence":"next","crossOrigin":"$undefined"}]]],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","(content)","children","articles","children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","(content)","children","articles","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[null,["$","div",null,{"className":"min-h-screen bg-white dark:bg-neutral-900","children":[["$","$L6",null,{}],["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","(content)","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]]}]],null],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/7b555c975a649a76.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_1e4310 __variable_c3aa02 min-h-screen font-sans antialiased bg-background text-foreground dark:bg-neutral-900 dark:text-neutral-100 transition-colors","children":["$","$L7",null,{"children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":"$8","children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":"$9","children":"404"}],["$","div",null,{"style":"$a","children":["$","h2",null,{"style":"$b","children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}]}]}]],null],null],["$Lc",null]]]]
d:I[3642,["513","static/chunks/513-54c786173a9c666c.js","189","static/chunks/189-76139bfb22cdcfc2.js","122","static/chunks/122-1e2541ae7fd00b15.js","637","static/chunks/637-6e55fbf6c1f17bbc.js","353","static/chunks/app/(content)/articles/%5Bslug%5D/page-e12b9a0df8b2e915.js"],"BackButton"]
e:I[3298,["513","static/chunks/513-54c786173a9c666c.js","189","static/chunks/189-76139bfb22cdcfc2.js","122","static/chunks/122-1e2541ae7fd00b15.js","637","static/chunks/637-6e55fbf6c1f17bbc.js","353","static/chunks/app/(content)/articles/%5Bslug%5D/page-e12b9a0df8b2e915.js"],"ClientShare"]
f:I[6231,["513","static/chunks/513-54c786173a9c666c.js","189","static/chunks/189-76139bfb22cdcfc2.js","122","static/chunks/122-1e2541ae7fd00b15.js","637","static/chunks/637-6e55fbf6c1f17bbc.js","353","static/chunks/app/(content)/articles/%5Bslug%5D/page-e12b9a0df8b2e915.js"],"LazyImage"]
10:I[1514,["513","static/chunks/513-54c786173a9c666c.js","189","static/chunks/189-76139bfb22cdcfc2.js","122","static/chunks/122-1e2541ae7fd00b15.js","637","static/chunks/637-6e55fbf6c1f17bbc.js","353","static/chunks/app/(content)/articles/%5Bslug%5D/page-e12b9a0df8b2e915.js"],""]
11:I[2181,["513","static/chunks/513-54c786173a9c666c.js","189","static/chunks/189-76139bfb22cdcfc2.js","122","static/chunks/122-1e2541ae7fd00b15.js","637","static/chunks/637-6e55fbf6c1f17bbc.js","353","static/chunks/app/(content)/articles/%5Bslug%5D/page-e12b9a0df8b2e915.js"],"ArticleContent"]
13:I[2027,["513","static/chunks/513-54c786173a9c666c.js","189","static/chunks/189-76139bfb22cdcfc2.js","122","static/chunks/122-1e2541ae7fd00b15.js","637","static/chunks/637-6e55fbf6c1f17bbc.js","353","static/chunks/app/(content)/articles/%5Bslug%5D/page-e12b9a0df8b2e915.js"],"TableOfContents"]
12:T6670,<h2 id="-ollama-introduction">ü¶ô Ollama introduction<span class="ml-2 opacity-0 hover:opacity-100"><a href="#-ollama-introduction" class="anchor" aria-hidden="true">#</a></span></h2>
<p><a href="https://ollama.com/">Ollama</a> is a powerful platform designed to make it easy for developers <strong>to run large language models (LLMs) directly on their local computers</strong>, without needing a <del>big server</del> or expensive hardware like <del>high-end GPUs</del>.</p>
<p>With <a href="https://ollama.com/">Ollama</a>, you can get up and running with models such as <code>Llama 3.3</code>, <code>Phi 3</code>, <code>Mistral</code>, <code>Gemma 2</code>, and more, all <del>without the need for specialized cloud infrastructure</del>.</p>
<p>In short, <a href="https://ollama.com/">Ollama</a> democratizes access to cutting-edge <code>AI models</code>, making them <strong>accessible on personal computers</strong> and empowering developers to build AI solutions without the burden of <del>expensive server infrastructure</del>.</p>
<h2 id="-why-use-json-schema-constraints-in-ollama">üîë Why Use JSON Schema Constraints in Ollama?<span class="ml-2 opacity-0 hover:opacity-100"><a href="#-why-use-json-schema-constraints-in-ollama" class="anchor" aria-hidden="true">#</a></span></h2>
<p><a href="https://ollama.com/">Ollama</a> now supports to constrain the output to a json
schema. <a href="https://ollama.com/blog/structured-outputs">https://ollama.com/blog/structured-outputs</a></p>
<p>Use cases for structured outputs include:</p>
<ul>
<li>Parsing data from documents</li>
<li>Extracting data from images</li>
<li>Structuring all language model responses</li>
<li>More reliability and consistency than JSON mode</li>
</ul>
<h2 id="-getting-started">üöÄ Getting Started<span class="ml-2 opacity-0 hover:opacity-100"><a href="#-getting-started" class="anchor" aria-hidden="true">#</a></span></h2>
<h3 id="1-install-ollama">1. Install Ollama<span class="ml-2 opacity-0 hover:opacity-100"><a href="#1-install-ollama" class="anchor" aria-hidden="true">#</a></span></h3>
<p>Download <a href="https://ollama.com/">Ollama</a> from <a href="https://ollama.com/download">https://ollama.com/download</a>. Choose the appropriate version for your
platform and complete the installation.</p>
<h3 id="2-verify-installation">2. Verify Installation<span class="ml-2 opacity-0 hover:opacity-100"><a href="#2-verify-installation" class="anchor" aria-hidden="true">#</a></span></h3>
<p>After installation, confirm the version by running:</p>
<pre><code class="hljs language-shell">ollama --version
</code></pre>
<p>expected output format:</p>
<pre><code class="hljs language-shell">ollama version is 0.5.1
</code></pre>
<h3 id="3-start-ollama-server">3. Start Ollama Server<span class="ml-2 opacity-0 hover:opacity-100"><a href="#3-start-ollama-server" class="anchor" aria-hidden="true">#</a></span></h3>
<p>Run the following command to start the server:</p>
<pre><code class="hljs language-shell">ollama serve
</code></pre>
<p>By default, the server runs on port 11434. You can verify this by
visiting <a href="http://localhost:11434">http://localhost:11434</a>.</p>
<h3 id="4-download-the-ollama-model">4. Download the Ollama Model<span class="ml-2 opacity-0 hover:opacity-100"><a href="#4-download-the-ollama-model" class="anchor" aria-hidden="true">#</a></span></h3>
<p>I recommend the <code>llama3.2</code> model for its compact size (<code>2.0 GB</code>) and impressive performance.</p>
<p>It features <code>3 billion</code> parameters and <strong>outperforms</strong> many larger models in industry benchmarks.</p>
<p>Download the model with:</p>
<pre><code class="hljs language-shell">ollama run llama3.2
</code></pre>
<p>Verify the download:</p>
<pre><code class="hljs language-shell">ollama list
</code></pre>
<p>Expected output:</p>
<pre><code class="hljs language-shell">NAME                       ID              SIZE      MODIFIED        
llama3.2:latest            a80c4f17acd5    2.0 GB    n weeks ago
</code></pre>
<h2 id="Ô∏è-run-using-curl">‚ñ∂Ô∏è Run using CURL<span class="ml-2 opacity-0 hover:opacity-100"><a href="#Ô∏è-run-using-curl" class="anchor" aria-hidden="true">#</a></span></h2>
<p>Run using curl directly to <a href="https://ollama.com/">Ollama</a> server <a href="http://localhost:11434">http://localhost:11434</a>.</p>
<p>There is no need to code, there is no setup, no need to install anything (*make sure you have curl installed).</p>
<h3 id="use-case-1-extract-country-data">Use Case 1: Extract Country Data<span class="ml-2 opacity-0 hover:opacity-100"><a href="#use-case-1-extract-country-data" class="anchor" aria-hidden="true">#</a></span></h3>
<blockquote>
<p>Input Prompt: "Tell me about Canada."</p>
</blockquote>
<h4 id="schema">Schema</h4>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"capital"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"languages"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"array"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"items"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"name"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"capital"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"languages"</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 id="curl-request">Curl Request</h4>
<p>json schema above included in the request in field <code>format</code>.</p>
<p>Run the following command in the terminal:</p>
<pre><code class="hljs language-bash">curl --location <span class="hljs-string">'http://127.0.0.1:11434/api/chat'</span> \
--header <span class="hljs-string">'Content-Type: application/json'</span> \
--data <span class="hljs-string">'{
  "model": "llama3.2",
  "messages": [{"role": "user", "content": "Tell me about Canada."}],
  "stream": false,
  "format": {
    "type": "object",
    "properties": {
      "name": { "type": "string" },
      "capital": { "type": "string" },
      "languages": { "type": "array", "items": { "type": "string" } }
    },
    "required": ["name", "capital", "languages"]
  }
}'</span>
</code></pre>
<h4 id="response">Response</h4>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"llama3.2"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"created_at"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-12-12T07:47:22.184905Z"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"role"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"assistant"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{ \"capital\": \"Ottawa\", \"languages\": [\"English\", \"French\"], \"name\":\"Canada\" }"</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"done_reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"stop"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"done"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"total_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1232600000</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"load_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">33616458</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"prompt_eval_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"prompt_eval_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">495000000</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"eval_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">29</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"eval_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">700000000</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>see field <code>message.content</code> using the same json schema as above</p>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"capital"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Ottawa"</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"languages"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"English"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-string">"French"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Canada"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h3 id="use-case-2-extract-pets-data">Use Case 2: Extract Pets Data<span class="ml-2 opacity-0 hover:opacity-100"><a href="#use-case-2-extract-pets-data" class="anchor" aria-hidden="true">#</a></span></h3>
<blockquote>
<p>Prompt: "I have two pets. A cat named Luna who is 5 years old and loves playing with yarn. She has grey fur. I also have a 2-year-old black cat named Loki who loves tennis balls."</p>
</blockquote>
<h4 id="schema-1">Schema</h4>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"$defs"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"Pet"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"integer"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"animal"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"anyOf"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">"const"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"black"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">"const"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"grey"</span>
            <span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"favorite_toy"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"anyOf"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
            <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">"const"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn"</span>
            <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
            <span class="hljs-punctuation">{</span>
              <span class="hljs-attr">"const"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tennis balls"</span>
            <span class="hljs-punctuation">}</span>
          <span class="hljs-punctuation">]</span>
        <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
          <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"string"</span>
        <span class="hljs-punctuation">}</span>
      <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
        <span class="hljs-string">"name"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"animal"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"age"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"color"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-string">"favorite_toy"</span>
      <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"properties"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"pets"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"array"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"items"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"$ref"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"#/$defs/Pet"</span>
      <span class="hljs-punctuation">}</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"required"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-string">"pets"</span>
  <span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span>
  <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"object"</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h4 id="curl-request-1">Curl Request</h4>
<pre><code class="hljs language-bash">curl --location <span class="hljs-string">'http://127.0.0.1:11434/api/chat'</span> \
--header <span class="hljs-string">'Content-Type: application/json'</span> \
--data <span class="hljs-string">'{
  "model": "llama3.2",
  "messages": [{
    "role": "user",
    "content": "I have two pets. A cat named Luna who is 5 years old and loves playing with yarn. She has grey fur. I also have a 2-year-old black cat named Loki who loves tennis balls."
  }],
  "stream": false,
  "format": {
    "$defs": {
      "Pet": {
        "properties": {
          "age": { "type": "integer" },
          "animal": { "type": "string" },
          "color": { "anyOf": [
            { "const": "black" },
            { "const": "grey" }
          ] },
          "favorite_toy": { "anyOf": [
            { "const": "yarn" },
            { "const": "tennis balls" }
          ] },
          "name": { "type": "string" }
        },
        "required": ["name", "animal", "age", "color", "favorite_toy"],
        "type": "object"
      }
    },
    "properties": {
      "pets": {
        "type": "array",
        "items": { "$ref": "#/$defs/Pet" }
      }
    },
    "required": ["pets"],
    "type": "object"
  }
}'</span>
</code></pre>
<h4 id="response-1">Response</h4>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
    <span class="hljs-attr">"model"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"llama3.2"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"created_at"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"2024-12-12T08:32:37.316804Z"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"message"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"role"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"assistant"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"content"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"{ \"pets\": [ { \"age\": 5, \"animal\": \"cat\", \"color\": \"grey\", \"favorite_toy\": \"yarn\" , \"name\": \"Luna\"}, { \"age\": 2, \"animal\": \"cat\", \"color\": \"black\", \"favorite_toy\": \"tennis balls\" , \"name\": \"Loki\"}] }"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"done_reason"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"stop"</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"done"</span><span class="hljs-punctuation">:</span> <span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"total_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">7159731958</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"load_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">829545916</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prompt_eval_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">68</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"prompt_eval_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">4620000000</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eval_count"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">82</span><span class="hljs-punctuation">,</span>
    <span class="hljs-attr">"eval_duration"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1697000000</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<p>see field <code>message.content</code> using the same json schema as above</p>
<pre><code class="hljs language-json"><span class="hljs-punctuation">{</span>
  <span class="hljs-attr">"pets"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"animal"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cat"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"grey"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"favorite_toy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"yarn"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Luna"</span>
    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span>
    <span class="hljs-punctuation">{</span>
      <span class="hljs-attr">"age"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"animal"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"cat"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"color"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"black"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"favorite_toy"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"tennis balls"</span><span class="hljs-punctuation">,</span>
      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Loki"</span>
    <span class="hljs-punctuation">}</span>
  <span class="hljs-punctuation">]</span>
<span class="hljs-punctuation">}</span>
</code></pre>
<h2 id="Ô∏è-run-using-demo-python-api">‚ñ∂Ô∏è Run using demo python api<span class="ml-2 opacity-0 hover:opacity-100"><a href="#Ô∏è-run-using-demo-python-api" class="anchor" aria-hidden="true">#</a></span></h2>
<p>Recommend to use python 3.10.* with venv</p>
<h3 id="1-create-venv">1. Create venv<span class="ml-2 opacity-0 hover:opacity-100"><a href="#1-create-venv" class="anchor" aria-hidden="true">#</a></span></h3>
<p>Clone this repository</p>
<pre><code class="hljs language-shell">git clone https://github.com/harryosmar/ollama-demo-python.git
</code></pre>
<p>Run the following command in the terminal:</p>
<pre><code class="hljs language-shell">cd ollama-demo-python

python3 -m venv venv
</code></pre>
<h3 id="2-activate-venv">2. Activate venv<span class="ml-2 opacity-0 hover:opacity-100"><a href="#2-activate-venv" class="anchor" aria-hidden="true">#</a></span></h3>
<p>Run the following command in the terminal:</p>
<pre><code class="hljs language-shell">source ./venv/bin/activate
</code></pre>
<h3 id="3-install-requirements">3. Install requirements<span class="ml-2 opacity-0 hover:opacity-100"><a href="#3-install-requirements" class="anchor" aria-hidden="true">#</a></span></h3>
<p>Run the following command in the terminal:</p>
<pre><code class="hljs language-shell">pip install -r requirements.txt
</code></pre>
<ul>
<li><a href="https://flask.palletsprojects.com/en/2.3.x/">Flask</a> used as api framework</li>
<li><a href="https://pydantic-docs.helpmanual.io/">pydantic</a> used for data validation, create json schema from python class</li>
</ul>
<h3 id="4-run-app">4. Run app<span class="ml-2 opacity-0 hover:opacity-100"><a href="#4-run-app" class="anchor" aria-hidden="true">#</a></span></h3>
<p>Run the following command in the terminal:</p>
<pre><code class="hljs language-shell">flask --app main run
</code></pre>
<p>Start api server in <a href="http://127.0.0.1:5000">http://127.0.0.1:5000</a></p>
<h3 id="5-swagger-endpoints">5. Swagger endpoints<span class="ml-2 opacity-0 hover:opacity-100"><a href="#5-swagger-endpoints" class="anchor" aria-hidden="true">#</a></span></h3>
<p><a href="http://127.0.0.1:5000/apidocs/">swagger access link http://127.0.0.1:5000/apidocs/</a></p>
<h2 id="-conclusion">üî• Conclusion<span class="ml-2 opacity-0 hover:opacity-100"><a href="#-conclusion" class="anchor" aria-hidden="true">#</a></span></h2>
<p>By leveraging JSON schema constraints, <a href="https://ollama.com/">Ollama</a> ensures structured, reliable, and predictable outputs from LLMs. Whether you‚Äôre parsing documents, analyzing images, or building robust APIs, this feature delivers the consistency and accuracy you need.</p>
<h2 id="-credits">üèÖ Credits<span class="ml-2 opacity-0 hover:opacity-100"><a href="#-credits" class="anchor" aria-hidden="true">#</a></span></h2>
<p>Give credits to <strong>Matt Williams</strong> with his <a href="https://www.youtube.com/@technovangelist">https://www.youtube.com/@technovangelist</a></p>
<p>He was part of the <strong>founding</strong> <a href="https://ollama.com/">Ollama</a> team. Don't forget to check out &#x26; subscribe to his channel, help him to reach 1 million subscribers.</p>
<p>I learned a lot from his videos, thank you Matt, hats off to you! üëè</p>2:["$","div",null,{"className":"min-h-screen","children":[["$","div",null,{"children":["$","div",null,{"className":"max-w-[692px] mx-auto px-4 pt-20 pb-12","children":[["$","div",null,{"className":"flex items-center justify-between mb-12","children":[["$","$Ld",null,{"href":"/articles","label":"‚Üê Articles","className":"text-sm text-neutral-500 hover:text-neutral-900 dark:hover:text-neutral-100"}],["$","$Le",null,{"type":"articles","slug":"ai-ollama-structured-output","title":"Unlocking the Power of AI: Ollama LLM with Structured Output"}]]}],["$","h1",null,{"className":"text-4xl font-bold tracking-tight text-neutral-900 dark:text-neutral-100 mb-8","children":"Unlocking the Power of AI: Ollama LLM with Structured Output"}],["$","div",null,{"className":"flex items-start gap-3 mb-12","children":[["$","div",null,{"className":"w-12 h-12 rounded-full overflow-hidden flex-shrink-0","children":["$","$Lf",null,{"src":"/images/about/harry.jpeg","alt":"Harry Osmar Sitohang","width":48,"height":48,"className":"w-full h-full object-cover"}]}],["$","div",null,{"className":"flex flex-col flex-1","children":[["$","div",null,{"className":"flex items-center justify-between","children":["$","$L10",null,{"href":"/about/harry-osmar-sitohang","className":"text-[15px] font-medium text-neutral-900 dark:text-neutral-100 hover:underline","children":"Harry Osmar Sitohang"}]}],["$","div",null,{"className":"flex items-center gap-1 text-[14px] text-neutral-500","children":[["$","div",null,{"className":"text-neutral-500","children":"Senior Principal Engineer"}],["$","span",null,{"children":"¬∑"}],["$","time",null,{"dateTime":"2024-12-12T22:53:00+07:00","children":"Dec 12, 2024"}],["$","span",null,{"children":"¬∑"}],["$","span",null,{"children":[6," min read"]}]]}]]}]]}],["$","div",null,{"className":"relative aspect-[16/9] rounded-lg overflow-hidden mb-12","children":["$","$Lf",null,{"src":"/images/articles/ai-ollama-structured-output.webp","alt":"Unlocking the Power of AI: Ollama LLM with Structured Output","fill":true,"className":"object-cover","priority":true}]}]]}]}],["$","div",null,{"className":"relative","children":["$","div",null,{"className":"lg:grid lg:grid-cols-[692px_250px] lg:gap-16 lg:justify-center","children":[["$","article",null,{"className":"mx-auto w-full px-4 pb-20","children":[["$","div",null,{"className":"sticky top-0 z-10 -mx-4 px-4 py-3 bg-white/95 dark:bg-neutral-900/95 backdrop-blur-sm border-b border-neutral-200 dark:border-neutral-800","children":["$","div",null,{"className":"flex items-center justify-between max-w-[692px] mx-auto","children":[["$","div",null,{"className":"flex items-center gap-4","children":["$","h2",null,{"className":"text-sm font-medium text-neutral-900 dark:text-neutral-100","children":"Unlocking the Power of AI: Ollama LLM with Structured Output"}]}],["$","$Le",null,{"type":"projects","slug":"ai-ollama-structured-output","title":"Unlocking the Power of AI: Ollama LLM with Structured Output"}]]}]}],["$","div",null,{"className":"mt-8 prose dark:prose-invert prose-neutral max-w-none prose-headings:font-serif prose-headings:tracking-tight prose-headings:font-normal prose-h2:text-[24px] prose-h2:leading-[32px] prose-p:text-neutral-800 dark:prose-p:text-neutral-200 prose-p:leading-[32px] prose-a:text-neutral-900 dark:prose-a:text-neutral-100 prose-a:decoration-neutral-300 dark:prose-a:decoration-neutral-700 hover:prose-a:decoration-neutral-600 dark:hover:prose-a:decoration-neutral-400","children":["$","$L11",null,{"content":"$12"}]}]]}],["$","aside",null,{"className":"hidden lg:block px-4","children":["$","div",null,{"className":"sticky top-8","children":["$","$L13",null,{}]}]}]]}]}]]}]
c:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Unlocking the Power of AI: Ollama LLM with Structured Output | Harry Osmar Sitohang | Harry Osmar Sitohang"}],["$","meta","3",{"name":"description","content":"JSON schema in Ollama ü¶ô, revolutionizes the way we handle data extraction, response structuring, and consistency"}],["$","meta","4",{"name":"robots","content":"index, follow"}],["$","meta","5",{"name":"application-name","content":"Harry Osmar Sitohang"}],["$","meta","6",{"name":"linkedin:card","content":"summary_large_image"}],["$","meta","7",{"name":"linkedin:title","content":"Unlocking the Power of AI: Ollama LLM with Structured Output | Harry Osmar Sitohang"}],["$","meta","8",{"name":"linkedin:description","content":"JSON schema in Ollama ü¶ô, revolutionizes the way we handle data extraction, response structuring, and consistency"}],["$","meta","9",{"name":"linkedin:image","content":"/images/articles/ai-ollama-structured-output.webp"}],["$","meta","10",{"name":"linkedin:creator","content":"Harry Osmar Sitohang"}],["$","meta","11",{"name":"al:ios:url","content":"linkedin://shareArticle?mini=true&url=https%3A%2F%2Fwww.harryosmarsitohang.com%2Farticles%2Fai-ollama-structured-output"}],["$","meta","12",{"name":"al:android:url","content":"linkedin://shareArticle?mini=true&url=https%3A%2F%2Fwww.harryosmarsitohang.com%2Farticles%2Fai-ollama-structured-output"}],["$","meta","13",{"name":"al:ios:app_store_id","content":"288429040"}],["$","meta","14",{"name":"al:android:package","content":"com.linkedin.android"}],["$","meta","15",{"name":"al:ios:app_name","content":"LinkedIn"}],["$","meta","16",{"name":"al:android:app_name","content":"LinkedIn"}],["$","meta","17",{"property":"og:title","content":"Unlocking the Power of AI: Ollama LLM with Structured Output | Harry Osmar Sitohang"}],["$","meta","18",{"property":"og:description","content":"JSON schema in Ollama ü¶ô, revolutionizes the way we handle data extraction, response structuring, and consistency"}],["$","meta","19",{"property":"og:url","content":"https://www.harryosmarsitohang.com/articles/ai-ollama-structured-output"}],["$","meta","20",{"property":"og:site_name","content":"Harry Osmar Sitohang"}],["$","meta","21",{"property":"og:locale","content":"en_US"}],["$","meta","22",{"property":"og:image","content":"https://www.harryosmarsitohang.com/images/articles/ai-ollama-structured-output.webp"}],["$","meta","23",{"property":"og:image:width","content":"1200"}],["$","meta","24",{"property":"og:image:height","content":"630"}],["$","meta","25",{"property":"og:image:alt","content":"Unlocking the Power of AI: Ollama LLM with Structured Output"}],["$","meta","26",{"property":"og:type","content":"article"}],["$","meta","27",{"property":"article:published_time","content":"2024-12-12T22:53:00+07:00"}],["$","meta","28",{"property":"article:author","content":"https://www.harryosmarsitohang.com/about/harry-osmar-sitohang"}],["$","meta","29",{"name":"twitter:card","content":"summary_large_image"}],["$","meta","30",{"name":"twitter:title","content":"Unlocking the Power of AI: Ollama LLM with Structured Output | Harry Osmar Sitohang"}],["$","meta","31",{"name":"twitter:description","content":"JSON schema in Ollama ü¶ô, revolutionizes the way we handle data extraction, response structuring, and consistency"}],["$","meta","32",{"name":"twitter:image","content":"https://www.harryosmarsitohang.com/images/articles/ai-ollama-structured-output.webp"}],["$","link","33",{"rel":"icon","href":"/favicon.ico","type":"image/x-icon","sizes":"16x16"}],["$","meta","34",{"name":"next-size-adjust"}]]
1:null
